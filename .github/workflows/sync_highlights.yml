name: Sync highlights to Roam

on:
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    strategy:
      matrix:
        python-version: [3.7]

    steps:
    # checkout repos
    - uses: actions/checkout@v2
    - name: Checkout remarkable-highlights repo
      uses: actions/checkout@v2
      with:
        repository: benlongo/remarkable-highlights
        path: remarkable-highlights

   # Setup Python and Poetry
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
    - uses: Gr1N/setup-poetry@v4
      
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        sudo apt-get install jq
        npm ci
        cd remarkable-highlights
        poetry install
    
    # run the scripts
    - name: Sync highlights
      run: |
        echo "run the scripts here"
